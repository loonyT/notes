Методы выделения кадров:
- Указатель количества байт
- Вставка байтов (byte stuffing)
- Вставка битов (bit stuffing)
- Средства физического уровня

Обнаружение и исправление ошибок:
1. Обнаружение ошибок
- Контрольная сумма
2. Исправление ошибок
- Коды исправляющие ошибки (с избыточной информацией)
- Позволяют обнаруживать и исправлять ошибки 
3. Повторная отправка данных
- Если в кадре обнаружена ошибка, его можно отправить заново. 
- Повторная отправка кадра, который не дошел до получателя

Типы повторной отправки:
1. Остановка и ожидание.
2. Скользящее окно.

Канальный уровень в модели OSI состоит из двух подуровней:
1. Подуровень управления логическим каналом (LLC)
- Отвечает за передачу данных (создание кадров, обработка ошибок и т.д.)
- Общий для разных технологий
2. Подуровень управления доступом к среде (MAC): 
- Совместное использование разделяемой среды
- Адресация
- Специфичный для разных технологий
- Не является обязательным

Технологии канального уровня:
- Ethernet, Wi-Fi (современные)
- Token Ring, FDDI, ATM, 100VG-AnyLAN (устаревшие)

#### Ethernet


*Классический Ethernet* использует разделяемую среду передачи данных. 
В такой среде данные в одно время может передавать только один компьютер, иначе возникнет коллизия и данные исказятся.

Классический Ethernet использует метод доступа к среде CSMA/CD:
- Carrier Sense Multiple Access with Collision Detection.
- Множественный доступ с прослушиванием несущей частоты и обнаружением коллизий.

*Коммутируемый Ethernet* - совершенно другая сетевая технология по сравнению с классическим Ethernet. 
Основное отличие: отказ от разделяемой среды передачи данных. Поэтому коллизии не возникают.

Для коммутируемого Ethernet необходимо новое устройство: коммутатор (switch).

Коммутатор использует полносвязную топологию.

Коммутатор работает на канальном уровне: он анализирует заголовок канального уровня и передает данные только компьютеру получателя, а не всем компьютерам в сети, как это делает концентратор.

Основные особенности работы коммутаторов:
1. Таблица коммутации - Соответствие MAC-адресов портам коммутатора.
2. Алгоритм обратного обучения - Заполнение таблицы коммутации.
3. Алгоритм прозрачного моста - Передача кадров коммутатором.

Преимущества коммутаторов:
- высокая производительность и масштабируемость
- высокая безопасность.


#### MAC address

Служат для идентификации сетевых интерфейсов узлов сети.

MAC-адреса применются в технологиях канального уровня:
- Ethernet (IEEE 802.3)
- Wi-Fi (IEEE 802.11)

Регламентированы стандартом IEEE 802. Длина 6 байт (48 бит)
Форма записи – шесть шестнадцатеричных чисел:
1C-75-08-D2-49-45
1C:75:08:D2:49:45

#### VLAN

VLAN (Virtual Local Area Network, Виртуальная локальная сеть) - технология разделения единой сети на несколько логических сетей, изолированных друг от друга.

В модели OSI и TCP/IP технология VLAN находится на канальном уровне и реализуется на коммутаторах.

Преимущества изоляции локальных сетей:
- Безопасность.
- Распределение нагрузки.
- Ограничение широковещательного трафика.

Для описания VLAN используются номера. Компьютеры, подключенные к VLAN с разными номерами, не могут передавать данные друг другу.

Типы VLAN:
- На основе коммутаторов (нетегированные). Номер VLAN задается в таблице коммутации. Работает только внутри одного коммутатора.
- Тегированные - номер VLAN передается в кадре Ethernet (стандарт IEEE 802.1Q). Может использоваться в сети с несколькими коммутаторами.


#### STP

Протокол связующего (остовного) дерева (Spanning Tree Protocol, STP) позволяет автоматически отключать дублирующие соединений в Ethernet, чтобы в сети не образовалось кольца и широковещательного шторма.

Протокол STP определен в стандарте IEEE 802.1D.

Преимущества STP:
- Надежность соединений между коммутаторами.
- Защита от ошибок конфигурации.

Протокол STP работает в 3 этапа:
1. Выбор корневого коммутатора
2. Определение кратчайших путей до корневого коммутатора
3. Отключение всех остальных соединений

Для реализация STP коммутаторы каждые 2 секунды отправляют управляющие сообщения Bridge Protocol Data Units (BPDU) на групповой адрес STP 01:80:C2:00:00:00.

Расширения протокола STP.
RSTP (Rapid Spanning Tree Protocol):
- Срабатывает быстрее при подключении оборудования и изменении конфигурации сети
- Стандарт IEEE 802.1w
STP и VLAN: 
- Multiple Spanning Tree Protocol (MSTP), 802.1s
- Отдельное связующее дерево для каждого VLAN


#### WI-FI

Wi-Fi – торговая марка, принадлежит компании Wi-Fi Alliance.
Технология Wi-Fi описана в стандартах серии IEEE 802.11.

В модели OSI Wi-Fi находится на канальном уровне.

Wi-Fi может работать в двух режимах:
- инфраструктурном
- одноранговом.

TO PRACTICE:

Для исследования сетей Wi-Fi мы используем программу inSSIDer.

inSSIDer показывает список действующих Wi-Fi сетей в виде таблицы и графическое представления использования спектра Wi-Fi в диапазоно 2,4 и 5 ГГц. В диапазоне 2,4 ГГц работает много сетей, эта ситуация называется Wi-Fi джунгли. Диапазон 5 ГГц почти пуст.

Wi-Fi может использовать пропускную способность 20 и 40 МГц, а для диапазона 5 ГЦ дополнительно 80 и 160 МГц. Для этого необходимо передавать данные на нескольких каналах, которые не пересекаются.

Рассматриваются подходы к выбору канала для своей сети Wi-Fi. Для стабильной долговременной работы лучше использовать автоматический выбор канала. Но допускается и ручная настройка после предварительной диагностики.

Попробуйте использовать разные каналы для работы сети Wi-Fi и посмотрите, как выбор канали и количество сетей, работающих на том же канале, влияет на скорость передачи данных.

##### CSMA/CA/MACA

Wi-Fi использует для передачи данных разделяемую среду - радиоэфир. В разделяемой среде возможны коллизии. Чтобы их избежать, необходим метод доступа к среде, который бы обеспечивал, что в один момент времени данные передает только один компьютер.

Особенности беспроводной среды:
- Вероятность ошибки передачи выше, чем в проводной среде
- Мощность передаваемого сигнала намного выше, чем принимаемого
- Ограниченный диапазон распространения сигнала – не все компьютеры в сети получают данные (проблема скрытой станции и проблема засвеченной станции).

Так как ошибки при передаче данных возникают часто, то в Wi-Fi на канальном уровне используется подтверждение доставки.

Коллизии в Wi-Fi обнаруживаются по отсутствию подтверждений. 

Коллизия в Wi-Fi обходится очень дорого, т.к. требуют больших
временных затрат на обнаружение: время передачи кадра и тайм-аут ожидания подтверждения.

Поэтому в Wi-Fi используется метод CSMA/CA - ножественный доступ с прослушиванием несущей частоты с предотвращением коллизий.

Другой метод доступа к среда в Wi-Fi: протокол Multiple Access with Collision Avoidance (MACA). Он позволяет решить проблему скрытой и засвеченной станции. Однако на практике метода CSMA/CA почти всегда достаточно, поэтому поддержка протокола MACA в оборудовании Wi-Fi не обязательна.

В MACA перед передачей данный компьютер отправляет короткое сообщение Request To Send (RTS). Принимающий компьютер в ответ передает сообщение Clear To Send (CTS). После этого отправитель может передавать данные.

##### Формат кадра IEEE 802.11 and on the MAC level

Wi-Fi использует два формата кадра. При передаче по беспроводной среде на уровне MAC используется формат кадра IEEE 802.11. Однако при поступлении на компьютер на уровне LLC происходит преобразование в формат кадра Ethernet.

Формат кадра IEEE 802.11 сильно отличается от формата Ethernet. Во-первых, в кадре Wi-Fi используется 4 MAC-адреса следующего назначения:
Адрес 1 - Адрес устройства, которое принимает данные из беспроводной среды (Receiver Address)
Адрес 2 - Адрес устройства, которое передает данные в беспроводную среду (Transmitter address).
Адрес 3 - Адрес устройства получателя (Destination Address).
Адрес 4 - Адрес устройства отправителя (Source Address).

Размер поля данных в Wi-Fi 2304 байта (в Ethernet размер поля данных 1500 байт).

Поле "Управление кадром" содержит большое количество управляющих флагов.

Типы кадров Wi-Fi:
- Кадры данных (передача данных)
- Кадры контроля (control frames). Служебные кадры (RTS, CTS, ACK)
- Кадры управления (management frames). Реализация сервисов Wi-Fi (например, ассоциация с точкой доступа).

Технология IEEE 802.11 Power Saving Mode позволяет экономить питание при работе Wi-Fi.

Фрагментация в Wi-Fi позволяет передавать данные, даже если ошибки возникают очень часто. При этом кадры делятся на отдельные части (фрагменты) и передаются отдельно.
